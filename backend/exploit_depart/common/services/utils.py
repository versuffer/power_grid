import random
import re
import string
from datetime import date, datetime


def calculate_timedelta(start_time, end_time):
    return datetime.combine(date.min, end_time) - datetime.combine(date.min, start_time)


def generate_random_string(str_len):
    return "".join(random.choices(string.printable, k=str_len))


def clean_multiple(instance, field_names, clean_pattern):
    patterns = {
        "object_names": "[^a-zA-Zа-яА-ЯёЁ0-9_\-()\[\]'\"/\\\\\t%!?<=>*#`,.:;+№ ]+",
        "person_names": "[^a-zA-Zа-яА-ЯёЁ]+",
    }

    for field in instance._meta.get_fields():
        if field.name in field_names:
            value = getattr(instance, field.name)
            value = re.sub(patterns[clean_pattern], "", value)
            if clean_pattern == "person_names":
                value = value.lower().capitalize()
            setattr(instance, field.name, value)
