from django.contrib import admin

from common.services.workdays_manager import add_workdays

from .models import TimeSheet, WorkDay


@admin.register(WorkDay)
class WorkDayAdmin(admin.ModelAdmin):
    list_display = [field.name for field in WorkDay._meta.get_fields()]


@admin.register(TimeSheet)
class TimeSheetAdmin(admin.ModelAdmin):
    list_display = ["timesheet_name", "period_start", "period_end"]
    filter_horizontal = ["employees", "workdays"]

    def save_related(self, request, form, formsets, change):
        super().save_related(request, form, formsets, change)
        timesheet = form.instance
        add_workdays(timesheet)
